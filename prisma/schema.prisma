// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum ScheduleType {
  work
  override
}

enum AcceptanceStatus {
  accepted
  pending
  declined
}

enum RateableType {
  trainerProfile
  playerProfile
  session
  field
  doctorClinic
}

enum UserType {
  admin
  user
  child
}

enum ProfileType {
  player
  trainer
}

enum Provider {
  facebook
  google
  apple
  native
}

enum LanguageEnum{
  en
  ar
}

enum NotificationSentTo{
  playerProfile
  trainerProfile
}

enum NotificationAbout{
  trainerSession
}

enum NotificationType{
  request
  accept
  reject
}

enum SessionStatus {
  active
  notActive
  canceled
}

enum SessionRequestType {
  new
  change
}

enum SessionRequestStatus {
  pending
  accepted
  rejected
}

enum CanceledByEnum {
  player
  trainer
}

model User {
  id              Int       @id @default(autoincrement())
  firstName       String?
  lastName        String?
  profileImage    String?
  password        String?
  email           String?   @unique
  mobileNumber    String    @unique
  birthday        DateTime?
  isPhoneVerified Boolean   @default(false)
  isActivated     Boolean   @default(true)

  userType  UserType? @default(user)
  fcm_token String?
  provider  Provider  @default(native)

  genderId Int?
  gender   Gender? @relation(fields: [genderId], references: [id])

  playerProfile         PlayerProfile?
  trainerProfile        TrainerProfile?
  fields                FieldsBookedHours[]
  doctorClinics         DoctorClinicsBookedHours[]
  trainerBookedSessions TrainerBookedSession[]
  addedFields           Field[]
  addedDoctorClinics    DoctorClinic[]
  parentsChilds         ParentsChilds[]            @relation("ParentsChilds")
  childsParents         ParentsChilds[]            @relation("ChildsParents")
  rates                 Rate[]
  notifications Notification[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Gender {
  id Int @id @default(autoincrement())

  name String

  user User[]
  genderTranslation GenderTranslation[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model GenderTranslation {
  id Int @id @default(autoincrement())

  name String

  language  LanguageEnum?

  gender   Gender? @relation(fields: [genderId], references: [id])
  genderId Int?

  @@unique([genderId, language])

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model ParentsChilds {
  id Int @id @default(autoincrement())

  parent   User @relation("ParentsChilds", fields: [parentId], references: [id])
  parentId Int

  child   User @relation("ChildsParents", fields: [childId], references: [id])
  childId Int

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  @@unique([parentId, childId])
}

model OTP {
  id           Int      @id @default(autoincrement())
  mobileNumber String
  otp          String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @default(now())
}

model PlayerProfile {
  id Int @id @default(autoincrement())

  regionId Int?
  region   Region? @relation(fields: [regionId], references: [id])

  levelId Int?
  level   Level? @relation(fields: [levelId], references: [id])

  sports PlayerProfileSports[]
  rates  Rate[]

  userId Int  @unique
  user   User @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model PlayerProfileSports {
  playerProfile   PlayerProfile @relation(fields: [playerProfileId], references: [id])
  playerProfileId Int
  sport           Sport         @relation(fields: [sportId], references: [id])
  sportId         Int

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  @@id([playerProfileId, sportId])
}

model TrainerProfile {
  id Int @id @default(autoincrement())

  ageGroup   AgeGroup? @relation(fields: [ageGroupId], references: [id])
  ageGroupId Int?

  levelId Int?
  level   Level? @relation(fields: [levelId], references: [id])

  sessionDescription String?

  cost Int? @default(200)

  hoursPriorToBooking Int? @default(24)

  rates Rate[]

  pictures Picture[]

  certificates Certificate[]

  sports TrainerProfileSports[]

  fields TrainerProfileFields[]

  userId Int  @unique
  user   User @relation(fields: [userId], references: [id], onDelete: Cascade)

  regionId Int?
  region   Region? @relation(fields: [regionId], references: [id])

  schedules Schedule[]

  notAvailableDays TrainerProfileNotAvailableDays[]

  trainerBookedSessions TrainerBookedSession[]

  defaultCancellationTime Int?

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Level {
  id Int @id @default(autoincrement())

  name String

  trainerProfiles TrainerProfile[]
  playerProfiles PlayerProfile[]
  levelTranslation LevelTranslation[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model LevelTranslation {
  id Int @id @default(autoincrement())

  name String

  language  LanguageEnum?

  level   Level? @relation(fields: [levelId], references: [id])
  levelId Int?

  @@unique([levelId, language])

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model AgeGroup {
  id Int @id @default(autoincrement())

  name String

  trainerProfiles TrainerProfile[]
  ageGroupTranslation AgeGroupTranslation[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model AgeGroupTranslation {
  id Int @id @default(autoincrement())

  name String

    language  LanguageEnum?

  ageGroup   AgeGroup? @relation(fields: [ageGroupId], references: [id])
  ageGroupId Int?

  @@unique([ageGroupId, language])

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Schedule {
  id Int @id @default(autoincrement())

  type ScheduleType @default(work)

  slots Slot[]

  TrainerProfile   TrainerProfile @relation(fields: [trainerProfileId], references: [id])
  trainerProfileId Int

  months SchedulesMonths[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Slot {
  id Int @id @default(autoincrement())

  name String?

  fromTime String
  toTime   String

  cost Int?

  weekDay   WeekDay? @relation(fields: [weekDayId], references: [id])
  weekDayId Int?

  Schedule   Schedule? @relation(fields: [scheduleId], references: [id],onDelete: SetNull)
  scheduleId Int?

  field   Field? @relation(fields: [fieldId], references: [id], onDelete: Cascade)
  fieldId Int?

  trainerBookedSessions TrainerBookedSession[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model WeekDay {
  id Int @id @default(autoincrement())

  dayNumber Int?
  dayName   String?

  slots          Slot[]

  weekDayTranslation  WeekDayTranslation[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model WeekDayTranslation {
  id Int @id @default(autoincrement())

  dayName   String?

  language  LanguageEnum?

  weekDay   WeekDay? @relation(fields: [weekDayId], references: [id])
  weekDayId Int?

  @@unique([weekDayId, language])

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Month {
  id Int @id @default(autoincrement())

  monthNumber Int?
  monthName   String?

  schedules SchedulesMonths[]
  monthTranslation  MonthTranslation[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model MonthTranslation {
  id Int @id @default(autoincrement())

  monthName   String?

  language  LanguageEnum?

  month   Month? @relation(fields: [monthId], references: [id])
  monthId Int?

  @@unique([monthId, language])

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model SchedulesMonths {
  id Int @id @default(autoincrement())

  schedule   Schedule @relation(fields: [scheduleId], references: [id],onDelete: Cascade)
  scheduleId Int

  month   Month @relation(fields: [monthId], references: [id])
  monthId Int

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  @@unique([scheduleId, monthId])
}

model TrainerProfileSports {
  trainerProfile   TrainerProfile @relation(fields: [trainerProfileId], references: [id])
  trainerProfileId Int

  sport   Sport @relation(fields: [sportId], references: [id])
  sportId Int

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  @@id([trainerProfileId, sportId])
}

model TrainerProfileFields {
  id Int @id @default(autoincrement())

  trainerProfile   TrainerProfile @relation(fields: [trainerProfileId], references: [id])
  trainerProfileId Int

  field   Field @relation(fields: [fieldId], references: [id])
  fieldId Int

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  @@unique([trainerProfileId, fieldId])
}

model TrainerBookedSession {
  id Int @id @default(autoincrement())

  status SessionStatus @default(notActive)

  gmt Int @default(0)

  date DateTime @db.Date

  sessionRequest SessionRequest?

  rates Rate[]

  notifications Notification[]

  canceledBy CanceledByEnum?

  cancellationReasons   CancellationReasons? @relation(fields: [cancellationReasonsId], references: [id], onDelete: SetNull)
  cancellationReasonsId Int?

  user   User @relation(fields: [userId], references: [id])
  userId Int

  trainerProfile   TrainerProfile @relation(fields: [trainerProfileId], references: [id])
  trainerProfileId Int

  slot   Slot @relation(fields: [slotId], references: [id])
  slotId Int

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  @@unique([date, slotId,userId])
}

model SessionRequest {
  id Int @id @default(autoincrement())

  trainerBookedSession   TrainerBookedSession @relation(fields: [trainerBookedSessionId], references: [id], onDelete: Cascade)
  trainerBookedSessionId Int                  @unique

  cancelReason   CancellationReasons? @relation(fields: [declineReasonId], references: [id], onDelete: SetNull)
  declineReasonId Int?

  type       SessionRequestType   @default(new)
  status     SessionRequestStatus @default(pending)

  newSessionDate  DateTime? @db.Date
  newSlotId Int?

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model CancellationReasons {
  id             Int              @id @default(autoincrement())
  name           String?

  trainerBookedSessions TrainerBookedSession[]
  sessionRequest SessionRequest[]
  cancellationReasonsTranslation    CancellationReasonsTranslation[]

  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @default(now())
}

model CancellationReasonsTranslation {
  id             Int              @id @default(autoincrement())

  name           String?
  language  LanguageEnum?

  cancellationReasons   CancellationReasons? @relation(fields: [cancellationReasonsId], references: [id])
  cancellationReasonsId Int?
  
  @@unique([cancellationReasonsId, language])
  
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @default(now())
}

model TrainerProfileNotAvailableDays {
  id      Int      @id @default(autoincrement())
  dayDate DateTime

  trainerProfile TrainerProfile @relation(fields: [trainerProfileId], references: [id])

  trainerProfileId Int

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Field {
  id          Int     @id @default(autoincrement())
  name        String
  description String?
  cost        Int?

  slotDuration      Int?
  address           String?
  longitude         Decimal?
  latitude          Decimal?
  profileImage      String?
  acceptanceStatus  AcceptanceStatus @default(pending)
  availableWeekDays Json?

  availableDayHours Json?
  rates             Rate[]

  slots Slot[]

  addedByUserId Int?
  addedByUser   User? @relation(fields: [addedByUserId], references: [id], onDelete: SetNull)

  sport   Sport? @relation(fields: [sportId], references: [id])
  sportId Int?

  region   Region? @relation(fields: [regionId], references: [id])
  regionId Int?

  users            FieldsBookedHours[]
  notAvailableDays FieldNotAvailableDays[]
  trainerProfiles  TrainerProfileFields[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Rate {
  id Int @id @default(autoincrement())

  ratingNumber Int?

  feedback String?

  rateableType RateableType

  profileType ProfileType @default(player)

  user   User @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId Int

  field   Field? @relation(fields: [fieldId], references: [id], onDelete: Cascade)
  fieldId Int?

  doctorClinic   DoctorClinic? @relation(fields: [doctorClinicId], references: [id], onDelete: Cascade)
  doctorClinicId Int?

  trainerProfile   TrainerProfile? @relation(fields: [trainerProfileId], references: [id], onDelete: Cascade)
  trainerProfileId Int?

  playerProfile   PlayerProfile? @relation(fields: [playerProfileId], references: [id], onDelete: Cascade)
  playerProfileId Int?

  trainerBookedSession   TrainerBookedSession? @relation(fields: [trainerBookedSessionId], references: [id], onDelete: Cascade)
  trainerBookedSessionId Int?

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Picture {
  id Int @id @default(autoincrement())

  imageLink String

  doctorClinic   DoctorClinic? @relation(fields: [doctorClinicId], references: [id], onDelete: Cascade)
  doctorClinicId Int?

  trainerProfile   TrainerProfile? @relation(fields: [trainerProfileId], references: [id], onDelete: Cascade)
  trainerProfileId Int?

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Certificate {
  id Int @id @default(autoincrement())

  name String

  imageLink String

  trainerProfile   TrainerProfile? @relation(fields: [trainerProfileId], references: [id], onDelete: Cascade)
  trainerProfileId Int?

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model DoctorClinic {
  id                Int              @id @default(autoincrement())
  name              String
  description       String?
  qualifications    String?
  cost              Int?
  slotDuration      Int?
  address           String?
  longitude         Decimal?
  latitude          Decimal?
  profileImage      String?
  acceptanceStatus  AcceptanceStatus @default(pending)
  availableWeekDays Json?

  availableDayHours Json?

  rates Rate[]

  pictures Picture[]

  addedByUserId Int?
  addedByUser   User? @relation(fields: [addedByUserId], references: [id], onDelete: Cascade)

  region   Region? @relation(fields: [regionId], references: [id])
  regionId Int?

  doctorClinicSpecialization   DoctorClinicSpecialization? @relation(fields: [doctorClinicSpecializationId], references: [id])
  doctorClinicSpecializationId Int?

  users            DoctorClinicsBookedHours[]
  notAvailableDays DoctorClinicNotAvailableDays[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model DoctorClinicSpecialization {
  id Int @id @default(autoincrement())

  name String

  doctorClinc DoctorClinic[]
  doctorClinicSpecializationTranslation DoctorClinicSpecializationTranslation[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model DoctorClinicSpecializationTranslation {
  id Int @id @default(autoincrement())

  name   String?

  language  LanguageEnum?

  doctorClinicSpecialization   DoctorClinicSpecialization? @relation(fields: [doctorClinicSpecializationId], references: [id])
  doctorClinicSpecializationId Int?

  @@unique([doctorClinicSpecializationId, language])

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model FieldNotAvailableDays {
  id      Int      @id @default(autoincrement())
  dayDate DateTime

  field   Field @relation(fields: [fieldId], references: [id])
  fieldId Int

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model DoctorClinicNotAvailableDays {
  id      Int      @id @default(autoincrement())
  dayDate DateTime

  doctorClinic   DoctorClinic @relation(fields: [doctorClinicId], references: [id])
  doctorClinicId Int

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model FieldsBookedHours {
  id Int @id @default(autoincrement())

  fromDateTime DateTime
  gmt          Int      @default(0)

  user   User @relation(fields: [userId], references: [id])
  userId Int

  field   Field @relation(fields: [fieldId], references: [id])
  fieldId Int

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model DoctorClinicsBookedHours {
  id Int @id @default(autoincrement())

  fromDateTime DateTime
  gmt          Int      @default(0)

  user   User @relation(fields: [userId], references: [id])
  userId Int

  doctorClinic   DoctorClinic @relation(fields: [doctorClinicId], references: [id])
  doctorClinicId Int

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Sport {
  id Int @id @default(autoincrement())

  name String?

  playerProfiles  PlayerProfileSports[]
  trainerProfiles TrainerProfileSports[]
  fields          Field[]
  sportTranslation          SportTranslation[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model SportTranslation{
  id Int @id @default(autoincrement())

  name  String?

  language  LanguageEnum?

  sport   Sport? @relation(fields: [sportId], references: [id])
  sportId Int?

  @@unique([sportId, language])

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Region {
  id Int @id @default(autoincrement())

  name String?

  playerProfile  PlayerProfile[]
  trainerProfile TrainerProfile[]
  fields         Field[]
  doctorClinc    DoctorClinic[]
  regionTranslation    RegionTranslation[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model RegionTranslation{
  id Int @id @default(autoincrement())

  name  String?

  language  LanguageEnum?

  region   Region? @relation(fields: [regionId], references: [id])
  regionId Int?

  @@unique([regionId, language])

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Feedback {
  id Int @id @default(autoincrement())

  content String?

  feedbackTranslation    FeedbackTranslation[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model FeedbackTranslation {
  id Int @id @default(autoincrement())

  content String?

  language  LanguageEnum?

  feedback   Feedback? @relation(fields: [feedbackId], references: [id])
  feedbackId Int?

  @@unique([feedbackId, language])

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model Notification {
  id Int @id @default(autoincrement())

  sentTo  NotificationSentTo?

  about NotificationAbout?

  type  NotificationType?

  notificationContent   NotificationContent? @relation(fields: [notificationContentId], references: [id])
  notificationContentId Int?

  seen Boolean @default(false)
  
  user   User @relation(fields: [userId], references: [id])
  userId Int
  
  trainerBookedSession   TrainerBookedSession? @relation(fields: [trainerBookedSessionId], references: [id], onDelete: Cascade)
  trainerBookedSessionId Int?


  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model NotificationContent{
  id Int @id @default(autoincrement())

  content String?

  notificationContentTranslation  NotificationContentTranslation[]

  notification  Notification[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model NotificationContentTranslation {
  id Int @id @default(autoincrement())

  content   String?

  language  LanguageEnum?

  notificationContent   NotificationContent? @relation(fields: [notificationContentId], references: [id])
  notificationContentId Int?

  @@unique([notificationContentId, language])

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}


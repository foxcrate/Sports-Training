// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum Gender {
  female
  male
}

enum AcceptanceStatus{
  accepted
  pending
  declined
}

enum RateableType {
  trainer
  field
  doctorClinic
}

enum UserType {
  admin
  user
  child
}

enum Provider {
  facebook
  google
  apple
  native
}

enum Level {
  beginner
  intermediate
  advanced
}


model User {
  id                  Int                   @id @default(autoincrement())
  firstName           String?
  lastName            String?
  profileImage        String?
  password            String?
  email               String?                @unique
  mobileNumber        String                  @unique
  gender              Gender?
  birthday            DateTime?
  isPhoneVerified     Boolean               @default(false)
  isActivated         Boolean               @default(true)
  createdAt           DateTime              @default(now())
  
  userType            UserType?             @default(user)
  fcm_token           String?
  provider            Provider              @default(native)
  
  playerProfile       PlayerProfile?
  trainerProfile      TrainerProfile?
  fields              FieldsBookedHours[]
  doctorClinics       DoctorClinicsBookedHours[]
  addedFields         Field[]
  addedDoctorClinics  DoctorClinic[]
  parentsChilds       ParentsChilds[] @relation("ParentsChilds")
  childsParents       ParentsChilds[] @relation("ChildsParents")
  rates               Rate[]
}

model ParentsChilds{
  id                  Int           @id @default(autoincrement())

  parent              User          @relation("ParentsChilds",fields: [parentId], references: [id])
  parentId            Int

  child               User          @relation("ChildsParents",fields: [childId], references: [id])
  childId             Int

  @@unique([parentId,childId])

  createdAt           DateTime      @default(now())
}

model OTP{
  id                    Int                   @id @default(autoincrement())
  mobileNumber          String
  otp                   String
  createdAt           DateTime              @default(now())
}

model PlayerProfile{
  id                    Int                   @id @default(autoincrement())

  level                 Level?

  regionId              Int?          
  region                Region?               @relation(fields: [regionId], references: [id])

  sports                PlayerProfileSports[]

  userId                Int                   @unique
  user                  User                  @relation(fields: [userId], references: [id],onDelete: Cascade)

  createdAt           DateTime              @default(now())
}

model PlayerProfileSports{
  playerProfile       PlayerProfile     @relation(fields: [playerProfileId], references: [id])
  playerProfileId     Int
  sport               Sport @relation(fields: [sportId], references: [id])
  sportId             Int

  @@id([playerProfileId, sportId])

  createdAt           DateTime              @default(now())
}

model TrainerProfile{
  id                  Int         @id @default(autoincrement())

  level             Level       @default(beginner)


  sports                TrainerProfileSports[]

  userId              Int         @unique
  user                User        @relation(fields: [userId], references: [id],onDelete: Cascade)

  createdAt           DateTime              @default(now())
}

model TrainerProfileSports{
  trainerProfile       TrainerProfile     @relation(fields: [trainerProfileId], references: [id])
  trainerProfileId     Int

  sport               Sport @relation(fields: [sportId], references: [id])
  sportId             Int

  @@id([trainerProfileId, sportId])

  createdAt           DateTime              @default(now())
}

model Field{
  id                  Int                    @id @default(autoincrement())
  name                String
  description         String?
  cost                Int?

  slotDuration        Int?
  address             String?
  longitude           Decimal?
  latitude            Decimal?
  profileImage        String?
  acceptanceStatus    AcceptanceStatus        @default(pending)
  availableWeekDays   Json?

  availableDayHours   Json?      
  rates                 Rate[]

  addedByUserId       Int?
  addedByUser         User?                @relation(fields: [addedByUserId], references: [id],onDelete: Cascade)
  
  sport               Sport? @relation(fields: [sportId], references: [id])
  sportId             Int?

  region               Region? @relation(fields: [regionId], references: [id])
  regionId             Int?

  users               FieldsBookedHours[]
  notAvailableDays    FieldNotAvailableDays[]

  createdAt           DateTime              @default(now())
}


model Rate{
  id                    Int                 @id @default(autoincrement())

  ratingNumber          Int?

  feedback              String?

  rateableType          RateableType

  user                  User @relation(fields: [userId], references: [id],onDelete: Cascade)
  userId                Int  
  
  field                 Field? @relation(fields: [fieldId], references: [id],onDelete: Cascade)
  fieldId               Int?  

  doctorClinic          DoctorClinic? @relation(fields: [doctorClinicId], references: [id], onDelete: Cascade)
  doctorClinicId        Int?  
}

model DoctorClinic{
  id                  Int                    @id @default(autoincrement())
  name                String
  description         String?
  cost                Int?
  slotDuration        Int?
  address             String?
  longitude           Decimal?
  latitude            Decimal?
  profileImage        String?
  acceptanceStatus    AcceptanceStatus        @default(pending)
  availableWeekDays   Json?

  availableDayHours   Json?   

  rates        Rate[]

  addedByUserId             Int?
  addedByUser               User?                @relation(fields: [addedByUserId], references: [id],onDelete: Cascade)

  region                    Region? @relation(fields: [regionId], references: [id])
  regionId                  Int?

  doctorClinicSpecialization      DoctorClinicSpecialization? @relation(fields: [doctorClinicSpecializationId], references: [id])
  doctorClinicSpecializationId    Int?

  users               DoctorClinicsBookedHours[]
  notAvailableDays    DoctorClinicNotAvailableDays[]

  createdAt           DateTime              @default(now())
}

model DoctorClinicSpecialization{
  id                    Int                 @id @default(autoincrement())

  name                String

  doctorClinc           DoctorClinic[]

  createdAt           DateTime              @default(now())
}

model FieldNotAvailableDays{
  id                  Int                    @id @default(autoincrement())
  dayDate             DateTime

  field               Field @relation(fields: [fieldId], references: [id])
  fieldId             Int

  createdAt           DateTime              @default(now())
}

model DoctorClinicNotAvailableDays{
  id                  Int                    @id @default(autoincrement())
  dayDate             DateTime

  doctorClinic        DoctorClinic @relation(fields: [doctorClinicId], references: [id])
  doctorClinicId      Int

  createdAt           DateTime              @default(now())
}

model FieldsBookedHours{
  id                  Int                    @id @default(autoincrement())

  fromDateTime                DateTime
  gmt                 Int                   @default(0)
  
  user               User @relation(fields: [userId], references: [id])
  userId             Int

  field               Field @relation(fields: [fieldId], references: [id])
  fieldId             Int

  createdAt           DateTime              @default(now())
}

model DoctorClinicsBookedHours{
  id                  Int                    @id @default(autoincrement())

  fromDateTime                DateTime
  gmt                 Int                   @default(0)
  
  user                User @relation(fields: [userId], references: [id])
  userId              Int

  doctorClinic        DoctorClinic @relation(fields: [doctorClinicId], references: [id])
  doctorClinicId      Int

  createdAt           DateTime              @default(now())
}

model Sport{
  id                  Int                   @id @default(autoincrement())

  name                String?

  playerProfiles      PlayerProfileSports[]
  trainerProfiles     TrainerProfileSports[]
  fields              Field[]

  createdAt           DateTime              @default(now())
}

model Region{
  id                    Int                 @id @default(autoincrement())
  
  name                  String?

  playerProfile         PlayerProfile[]
  fields                Field[]
  doctorClinc           DoctorClinic[]

  createdAt           DateTime              @default(now())
}

// model Internationalization{
//   id                    Int                 @id @default(autoincrement())

//   tableName             String
//   rowName               String
//   en                    String
//   ar                    String

//   createdAt             DateTime              @default(now())
// }